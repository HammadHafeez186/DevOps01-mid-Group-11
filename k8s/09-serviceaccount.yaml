# ==============================================================================
# Step 5: Kubernetes Deployment (Service Account & Security)
# ==============================================================================
# Goal: Provision infrastructure / Kubernetes Deployment
# Requirement: No hardcoded secrets / IAM Integration
#
# This ServiceAccount is mapped to an AWS IAM Role via annotations.
# It enables "IRSA" (IAM Roles for Service Accounts), allowing pods to assume
# AWS permissions (e.g., S3 access) securely without long-lived credentials.
# ==============================================================================

apiVersion: v1
kind: ServiceAccount
metadata:
  name: app-sa
  namespace: devops-articles
  annotations:
    # IAM Role ARN for EKS Pod Identity / IRSA.
    # This role trusts the OIDC provider of the EKS cluster.
    # Enables access to AWS services like S3 or Secrets Manager.
    eks.amazonaws.com/role-arn: arn:aws:iam::322467327252:role/devops-admin
  labels:
    app: devops-articles
